{"version":3,"file":"commonHelpers2.js","sources":["../src/js/books-api.js","../src/js/shop-list.js","../src/js/pagination.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getData(endpoint, userCategory = '') {\n  const url = `https://books-backend.p.goit.global/books/${endpoint}`;\n\n  let params = {};\n  if (userCategory) {\n    const str = userCategory.split(' ').join('%20');\n    params.category = str;\n  }\n\n  return await axios.get(url, {\n    params: params,\n    paramsSerializer: params => {\n      return Object.keys(params)\n        .map(key => `${key}=${params[key]}`)\n        .join('&');\n    },\n  });\n}\n","import { getData } from './books-api';\nimport { addToLS, getFromLS } from './local-storage-functions';\n// import { isSigned, saveBooksToFB } from './modal-authorization';\n// import{keyToLS} from './refs'\n\nconst bookIds1 = [\"643282b1e85766588626a086\",\"643282b1e85766588626a0b4\",\"643282b1e85766588626a0d4\",\"643282b2e85766588626a116\",\"643282b2e85766588626a116\",\"643282b2e85766588626a136\"];\n\nconst keyToLS = 'booksId';\naddToLS(keyToLS, bookIds1);\nconst shoppingList = document.querySelector('.shopping-list-gallery-books');\n\n// Fonction pour récupérer les données des livres\nasync function fetchBookData() {\n  const booksIds = getFromLS(keyToLS);\n  try {\n    const array = booksIds.map(bookId => getData(bookId));\n    const results = await Promise.allSettled(array);\n    const fulfilledResults = results.filter(promise => promise.status === 'fulfilled');\n    const booksArray = fulfilledResults.map(result => result.value.data);\n\n    // const bookIdsArray = booksArray.map(book => book._id);\n\n    return booksArray;\n  } catch (error) {\n    console.error('Error fetching book data:', error);\n    return [];\n  }\n}\n\n// Fonction pour afficher les livres\nasync function renderBooks() {\n  try {\n    const booksArray = await fetchBookData();\n\n    const booksMarkup = booksArray.map(book => {\n      const {\n        book_image: image,\n        title,\n        author,\n        description,\n        _id: id,\n        buy_links,\n      } = book;\n      const [amazon, applebooks] = buy_links;\n      return `<li class=\"shopping-list-books-items\">\n                <div class=\"shopping-list-books-information\">\n                  <div class=\"shopping-list-basket-img\">\n                    <img class=\"shopping-list-img\" src=\"${image}\"/>\n                  </div>\n                  <div>\n                    <h2 class=\"shopping-list-books-title\">${title}</h2>\n                    <button data-book-id=\"${id}\" type=\"button\" class=\"shopping-list-button\">\n                      <svg data-book-id=\"${id}\" class=\"shopping-list-delete\">\n                        <use href=\"./img/icons.svg#icon-trash\"></use>\n                      </svg>\n                    </button>\n                    <h3 class=\"shopping-list-books-category\">Category</h3>\n                    <p class=\"shopping-list-books-desc\">${description}</p>\n                    <p class=\"shopping-list-author\">${author}</p>\n                    <ul class=\"shopping-list-shop-list\">\n                      <li class=\"shopping-list-shop-list-items\">\n                        <a class=\"shopping-list-shop-list-link\" target=\"_blank\" href=\"${amazon.url}\">\n                          <img class=\"shopping-list-link-amazon\" src=\"./img/amazon.png\" alt=\"logo-amazon\">\n                        </a>\n                      </li>\n                      <li class=\"shopping-list-shop-list-items\">\n                        <a class=\"shopping-list-shop-list-link\" target=\"_blank\" href=\"${applebooks.url}\">\n                          <img class=\"shopping-list-link-apple\" src=\"./img/applebooks.png\" alt=\"apple-books\">\n                        </a>\n                      </li>\n                    </ul>\n                  </div>\n                </div>\n              </li>`;\n    }).join('');\n\n    shoppingList.innerHTML = booksMarkup;\n  } catch (error) {\n    console.error('Error rendering books:', error);\n  }\n}\n\n// Fonction pour supprimer un livre\nfunction bookOnDelete(e) {\n  e.preventDefault();\n  const id = e.target.dataset.bookId;\n  if (id) {\n  const booksIdArray = getFromLS(keyToLS);\n  const bookToRemoveIndex = booksIdArray.indexOf(id);\n  booksIdArray.splice(bookToRemoveIndex, 1);\n    addToLS(keyToLS, booksIdArray);\n    // if (isSigned) {\n    //   saveBooksToFB(booksIdArray);\n    // }\n    renderBooks();\n  } return\n\n}\n\n// Fonction à exécuter lors du chargement de la page pour les 2 états de la page\nfunction onPageLoad() {\n  const booksIdArray = getFromLS(keyToLS);\n  const shoppingListGallery = document.querySelector('.shopping-list-gallery-books');\n  const shoppingListEmptyState = document.querySelector('.shopping-list-empty-state');\n\n  if (booksIdArray.length > 0) {\n    renderBooks();\n    shoppingListGallery.style.display = 'block';\n    shoppingListEmptyState.style.display = 'none';\n    const shoppingListSection = document.querySelector('.shopping-list-section');\n    shoppingListSection.addEventListener('click', bookOnDelete);\n  } else {\n    shoppingListGallery.style.display = 'none';\n    shoppingListEmptyState.style.display = 'block';\n  }\n\n}\n\nonPageLoad();\n\n// Ajout du listener pour le chargement de la page\nshoppingList.addEventListener('click', bookOnDelete);\n","import tuiPagination from 'tui-pagination';\nimport { getFromLS } from './local-storage-functions';\n\nconst paginationElement = document.getElementById('pagination');\nconst itemsPerPage = 3;\n\nconst getTotalBooks = () => {\n    const myArray = getFromLS(\"idBooks\") || [];\n    return myArray.length;\n};\n\nconst updatePagination = (totalBooks, currentPage) => {\n    const visiblePages = window.innerWidth < 768 ? 2 : 3;\n\n    const pagination = new tuiPagination(paginationElement, {\n        totalItems: totalBooks,\n        itemsPerPage: itemsPerPage,\n        visiblePages: visiblePages,\n        page: currentPage,\n    });\n\n    pagination.on('afterMove', async (event) => {\n        const newPage = event.page;\n        localStorage.setItem('currentPage', newPage);\n    });\n\n    const paginationContainer = document.getElementById('pagination');\n    if (totalBooks <= 3) {\n        paginationContainer.style.display = 'none';\n    } else {\n        paginationContainer.style.display = 'flex';\n    }\n};\n\nlet currentPage = parseInt(localStorage.getItem('currentPage')) || 1;\nconst totalBooks = getTotalBooks();\nupdatePagination(totalBooks, currentPage);\n"],"names":["getData","endpoint","userCategory","url","params","str","axios","key","bookIds1","keyToLS","addToLS","shoppingList","fetchBookData","booksIds","getFromLS","array","bookId","promise","result","error","renderBooks","booksMarkup","book","image","title","author","description","id","buy_links","amazon","applebooks","bookOnDelete","e","booksIdArray","bookToRemoveIndex","onPageLoad","shoppingListGallery","shoppingListEmptyState","paginationElement","itemsPerPage","getTotalBooks","updatePagination","totalBooks","currentPage","visiblePages","tuiPagination","event","newPage","paginationContainer"],"mappings":"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"}