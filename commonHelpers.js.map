{"version":3,"file":"commonHelpers.js","sources":["../src/js/bestsellers.js","../src/js/categories.js"],"sourcesContent":["import { getData } from './books-api';\nimport { showLoader, hideLoader } from './loader.js';\nimport { onCategoryClick } from './categories.js';\nimport {\n  renderCategoriesList,\n  renderTitle,\n  changeCategoryColor,\n} from './categories';\nimport { categoriesList } from './categories.js';\n// import { bookOnClick } from './modal-window';\n\nexport const booksContainer = document.querySelector('.books-container');\nasync function fetchTopBooks() {\n  const response = await getData('top-books');\n  const data = response.data;\n  return data;\n}\n\n// ФУНКЦІЯ ЯКА ВІДМАЛЬОВУЄ БЕСТСЕЛЕРИ\nexport async function renderBestSellersBooks() {\n  showLoader();\n  const booksArray = await fetchTopBooks();\n  const booksContainerMarkup = booksArray\n    .map(topBooks => {\n      const books = topBooks.books;\n      const title = topBooks.list_name;\n      return renderBooksBlock(books, title);\n    })\n    .join('');\n  const title = renderTitle('Best Sellers Books');\n  const markup = title + booksContainerMarkup;\n  booksContainer.innerHTML = markup;\n  changeCategoryColor();\n  hideLoader();\n}\n\n// функція для створення div-у з книгою\nfunction renderBooksBlock(books, title) {\n  const booksListMarkup = books.map(book => templateBook(book)).join('');\n  const bookSectionMarkup = `<div class=\"category-books-wrapper\"><h2 class=\"category-title-bestsellers\">${title}</h2><ul class=\"books-list\">${booksListMarkup}</ul><button type=\"button\" class=\"books-list-btn\"\" data-category-name=\"${title}\">See more</button></div>`;\n  return bookSectionMarkup;\n}\n\n// функція для створення li-шки з книгою\nfunction templateBook({ book_image, title, author, _id: id }) {\n  return `\n      <li class=\"book-item\" data-book-id=\"${id}\">\n        <div class=\"book-image-container\">\n          <img\n            class=\"book-image\"\n            src=\"${book_image}\"\n            alt=\"${title}\"\n          />\n          <div class=\"book-overlay\">QUICK VIEW</div>\n        </div>\n        <h3 class=\"book-title\">${title}</h3>\n        <p class=\"book-author\">${author}</p>\n      </li>\n    `;\n}\n// ВИКЛИКАЄТЬСЯ В МЕЙНІ 1 РАЗ ПРИ ЗАВАНТАЖЕННІ СТОРІНКИ\nexport async function onPageLoad() {\n  await renderCategoriesList();\n  await renderBestSellersBooks();\n  booksContainer.addEventListener('click', onCategoryClick);\n  // booksContainer.addEventListener('click', bookOnClick);\n  categoriesList.addEventListener('click', onCategoryClick);\n}\n\nonPageLoad();\n","import { getData } from './books-api';\nimport { renderBestSellersBooks } from './bestsellers';\nimport { booksContainer } from './bestsellers';\nimport { showLoader, hideLoader } from './loader.js';\nexport const categoriesList = document.querySelector('.categories-list');\n\n// Список категорій\nasync function fetchCategoriesList() {\n  const response = await getData('category-list');\n  return response;\n}\n\nexport async function renderCategoriesList() {\n  try {\n    const response = await fetchCategoriesList();\n    if (response.statusText !== 'OK') {\n      throw new Error('Server error');\n    }\n    const booksArray = response.data;\n    const inAlphabeticalOrder = booksArray.sort((a, b) =>\n      a.list_name.localeCompare(b.list_name)\n    );\n\n    const allCategoriesListItem = `<li class=\"categories-list-item\" ><p data-category-name=\"All Categories\">All Categories</p></li>`;\n    const markup = inAlphabeticalOrder\n      .map(\n        category =>\n          `<li class=\"categories-list-item\" >\n<p data-category-name=\"${category.list_name}\">${category.list_name}</p>\n</li>`\n      )\n      .join('');\n\n    categoriesList.innerHTML = allCategoriesListItem + markup;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// КНИЖКИ\nexport function renderTitle(categoryName) {\n  const categoryNameSplitted = categoryName.split(' ');\n  const titleLastWord = categoryNameSplitted[categoryNameSplitted.length - 1];\n  const categoryNameWithoutLastWord = categoryNameSplitted\n    .slice(0, -1)\n    .join(' ');\n\n  const pageTitle = `<h1 class=\"books-container-title\">${categoryNameWithoutLastWord}<span class=\"last-word-title\"> ${titleLastWord}</span></h1>`; // Вставити класс замість className // Класи в андріани беремо.\n  return pageTitle;\n}\n\n// Розміткa одного li елементу\nfunction renderBookByCategory(booksArray) {\n  const booksMarkup = booksArray\n    .map(book => {\n      const { book_image: image, title, author, _id: id } = book;\n      return `<li class=\"book-item\" data-book-id=\"${id}\">\n      <div class=\"book-image-container\">\n        <img\n          class=\"book-image\"\n          src=\"${image}\"\n          alt=\"${title}\"\n        />\n        <div class=\"book-overlay\">QUICK VIEW</div>\n      </div>\n      <h3 class=\"book-title\">${title}</h3>\n      <p class=\"book-author\">${author}</p>\n    </li>`;\n    })\n    .join('');\n  const markup = `<ul class=\"books-by-category-list\">${booksMarkup}</ul>`;\n  return markup;\n}\n\n// Це основна функція рендеру книжок за категорією. Імпортується до Андріани та вішається як колбек на слухач подій на кнопки See More\nasync function renderCategoryBooks(categoryName) {\n  showLoader();\n  const response = await getData('category', categoryName);\n  const booksArray = response.data;\n  const booksTitle = renderTitle(categoryName);\n  const books = renderBookByCategory(booksArray);\n  const allCategoriesButtonMarkup = `<button class=\"books-list-btn all-categories-btn\" type=\"button\" data-category-name=\"All Categories\">All Categories</button>`;\n  const markup = booksTitle + books + allCategoriesButtonMarkup;\n  booksContainer.innerHTML = markup;\n  hideLoader();\n  changeCategoryColor();\n}\n\n// Слухач подій\nexport async function onCategoryClick(event) {\n  const categoryName = event.target.dataset.categoryName;\n  if (categoryName === 'All Categories') {\n    booksContainer.innerHTML = '';\n    renderBestSellersBooks();\n    return;\n  } else if (categoryName) {\n    renderCategoryBooks(categoryName);\n  }\n  return;\n}\n\nexport function changeCategoryColor() {\n  const h1Text = document.querySelector('.books-container-title').textContent;\n  const lis = document.querySelectorAll(\n    '.categories-list > .categories-list-item > p'\n  );\n  lis.forEach(li => li.classList.remove('current-category'));\n\n  lis.forEach(li => {\n    const liText = li.textContent.trim();\n    const allCategoriesLi = 'All Categories';\n    const allCategoriesTitle = 'Best Sellers Books';\n    if (h1Text === allCategoriesTitle && liText === allCategoriesLi) {\n      li.classList.add('current-category');\n      return;\n    }\n  });\n  lis.forEach(li => {\n    const liText = li.textContent.trim();\n\n    if (h1Text === liText) {\n      li.classList.add('current-category');\n      return;\n    }\n  });\n}\n\nvar swiper = new Swiper('.mySwiper', {\n  direction: 'vertical',\n  slidesPerView: 'auto',\n  freeMode: true,\n  scrollbar: {\n    el: '.swiper-scrollbar',\n  },\n  mousewheel: true,\n});\n"],"names":["booksContainer","fetchTopBooks","getData","renderBestSellersBooks","showLoader","booksContainerMarkup","topBooks","books","title","renderBooksBlock","markup","renderTitle","changeCategoryColor","hideLoader","booksListMarkup","book","templateBook","book_image","author","id","onPageLoad","renderCategoriesList","onCategoryClick","categoriesList","fetchCategoriesList","response","inAlphabeticalOrder","a","b","allCategoriesListItem","category","error","categoryName","categoryNameSplitted","titleLastWord","renderBookByCategory","booksArray","image","renderCategoryBooks","booksTitle","allCategoriesButtonMarkup","event","h1Text","lis","li","liText"],"mappings":"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"}